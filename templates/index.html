{% extends 'base.html' %}

{% block content %}

<form method="POST" action="{{ url_for('handle_search') }}">
    <div class="form-group row">
        <label for="query" class="col-sm-2 col-form-label">Query</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" name="query" id="query" placeholder="Enter your search query"
                value="{{ query }}" autofocus>
        </div>
    </div>
    <div class="form-group row">
        <label for="login" class="col-sm-2 col-form-label">Taxon ID</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" name="taxon_id" id="taxon_id" placeholder="Taxon ID"
                value="{{ taxon_id }}" />
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-10">
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </div>
</form>

<br />

{% if results %}
<div class="row mb-3">
    {% for result in results %}
    <div class="card" style="width: 12rem;">
        <a href="https://www.inaturalist.org/observations/{{ result._source.observation_uuid }}">
            <img src="https://inaturalist-open-data.s3.amazonaws.com/photos/{{ result._source.photo_id }}/small.{{ result._source.extension }}"
                class="card-img-top img-responsive" alt="..."
                style="width: 100%; max-height: 140px; object-fit: none; object-position: center;" />
        </a>
        <div class="card-body">
            <small>
                Taxon Name:
                <a href="https://www.inaturalist.org/taxa/{{ result._source.taxon_id }}">
                    {{ result._source.taxon_name }}
                </a>
                <br />
                Photographer:
                <a href="https://www.inaturalist.org/users/{{ result._source.observer_login }}">
                    {{ result._source.observer_login }}
                </a>
                <br />
                {% if result._score %}<i>(Score: {{ result._score }})</i>{% endif %}
            </small>
        </div>
    </div>
    {% endfor %}
</div>
</div>
{% elif request.method == 'POST' %}
<p>No results found.</p>
{% endif %}
{% endblock %}